<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="containo.us">
        
        <link rel="shortcut icon" href="img/traefik.icon.png">
        

	<title>traefik.toml - Træfik</title>

        <link href="../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link rel="stylesheet" href="../css/highlight.css">
        <link href="../css/base.css" rel="stylesheet">
        <link href="../css/traefik.css" rel="stylesheet">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            <!-- Main title -->
            <a class="navbar-brand" href="..">Træfik</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            <!-- Main navigation -->
            <ul class="nav navbar-nav">
            
            
                <li >
                    <a href="..">Getting Started</a>
                </li>
            
            
            
                <li >
                    <a href="../basics/">Basics</a>
                </li>
            
            
            
                <li class="active">
                    <a href="./">traefik.toml</a>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">User Guide <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        
<li >
    <a href="../user-guide/examples/">Configuration examples</a>
</li>

                    
                        
<li >
    <a href="../user-guide/swarm/">Swarm cluster</a>
</li>

                    
                        
<li >
    <a href="../user-guide/swarm-mode/">Swarm mode cluster</a>
</li>

                    
                        
<li >
    <a href="../user-guide/kubernetes/">Kubernetes</a>
</li>

                    
                        
<li >
    <a href="../user-guide/marathon/">Marathon</a>
</li>

                    
                        
<li >
    <a href="../user-guide/kv-config/">Key-value store configuration</a>
</li>

                    
                        
<li >
    <a href="../user-guide/cluster/">Clustering/HA</a>
</li>

                    
                    </ul>
                </li>
            
            
            
                <li >
                    <a href="../benchmarks/">Benchmarks</a>
                </li>
            
            
            </ul>

            <!-- Search, Navigation and Repo links -->
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                <li >
                    <a rel="next" href="../basics/">
                        <i class="fa fa-arrow-left"></i> Previous
                    </a>
                </li>
                <li >
                    <a rel="prev" href="../user-guide/examples/">
                        Next <i class="fa fa-arrow-right"></i>
                    </a>
                </li>
                
                <li>
                    <a href="https://github.com/containous/traefik">
                        
                            <i class="fa fa-github"></i>
                        
                        GitHub
                    </a>
                </li>
                
            </ul>
        </div>
    </div>
</div>

        <div class="container">
            <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#global-configuration">Global configuration</a></li>
        
            <li><a href="#main-section">Main section</a></li>
        
            <li><a href="#entrypoints-definition">Entrypoints definition</a></li>
        
            <li><a href="#retry-configuration">Retry configuration</a></li>
        
            <li><a href="#health-check-configuration">Health check configuration</a></li>
        
            <li><a href="#acme-lets-encrypt-configuration">ACME (Let's Encrypt) configuration</a></li>
        
    
        <li class="main "><a href="#configuration-backends">Configuration backends</a></li>
        
            <li><a href="#file-backend">File backend</a></li>
        
            <li><a href="#api-backend">API backend</a></li>
        
            <li><a href="#docker-backend">Docker backend</a></li>
        
            <li><a href="#marathon-backend">Marathon backend</a></li>
        
            <li><a href="#mesos-generic-backend">Mesos generic backend</a></li>
        
            <li><a href="#kubernetes-ingress-backend">Kubernetes Ingress backend</a></li>
        
            <li><a href="#consul-backend">Consul backend</a></li>
        
            <li><a href="#consul-catalog-backend">Consul catalog backend</a></li>
        
            <li><a href="#etcd-backend">Etcd backend</a></li>
        
            <li><a href="#zookeeper-backend">Zookeeper backend</a></li>
        
            <li><a href="#boltdb-backend">BoltDB backend</a></li>
        
            <li><a href="#eureka-backend">Eureka backend</a></li>
        
            <li><a href="#ecs-backend">ECS backend</a></li>
        
    
        <li class="main "><a href="#rancher-backend">Rancher backend</a></li>
        
            <li><a href="#dynamodb-backend">DynamoDB backend</a></li>
        
    
    </ul>
</div></div>
            <div class="col-md-9" role="main">

<h1 id="global-configuration">Global configuration</h1>
<h2 id="main-section">Main section</h2>
<pre><code class="toml"># traefik.toml
################################################################
# Global configuration
################################################################

# Duration to give active requests a chance to finish during hot-reloads.
# Can be provided in a format supported by [time.ParseDuration](https://golang.org/pkg/time/#ParseDuration) or as raw
# values (digits). If no units are provided, the value is parsed assuming
# seconds.
#
# Optional
# Default: &quot;10s&quot;
#
# graceTimeOut = &quot;10s&quot;

# Enable debug mode
#
# Optional
# Default: false
#
# debug = true

# Periodically check if a new version has been released
#
# Optional
# Default: true
#
# checkNewVersion = false

# Traefik logs file
# If not defined, logs to stdout
#
# Optional
#
# traefikLogsFile = &quot;log/traefik.log&quot;

# Access logs file
#
# Optional
#
# accessLogsFile = &quot;log/access.log&quot;

# Log level
#
# Optional
# Default: &quot;ERROR&quot;
# Accepted values, in order of severity: &quot;DEBUG&quot;, &quot;INFO&quot;, &quot;WARN&quot;, &quot;ERROR&quot;, &quot;FATAL&quot;, &quot;PANIC&quot;
# Messages at and above the selected level will be logged.
#
# logLevel = &quot;ERROR&quot;

# Backends throttle duration: minimum duration in seconds between 2 events from providers
# before applying a new configuration. It avoids unnecessary reloads if multiples events
# are sent in a short amount of time.
# Can be provided in a format supported by [time.ParseDuration](https://golang.org/pkg/time/#ParseDuration) or as raw
# values (digits). If no units are provided, the value is parsed assuming
# seconds.
#
# Optional
# Default: &quot;2s&quot;
#
# ProvidersThrottleDuration = &quot;2s&quot;

# IdleTimeout: maximum amount of time an idle (keep-alive) connection will remain idle before closing itself.
# This is set to enforce closing of stale client connections.
# Can be provided in a format supported by [time.ParseDuration](https://golang.org/pkg/time/#ParseDuration) or as raw
# values (digits). If no units are provided, the value is parsed assuming seconds.
#
# Optional
# Default: &quot;180s&quot;
#
# IdleTimeout = &quot;360s&quot;

# Controls the maximum idle (keep-alive) connections to keep per-host. If zero, DefaultMaxIdleConnsPerHost
# from the Go standard library net/http module is used.
# If you encounter 'too many open files' errors, you can either increase this
# value or change the `ulimit`.
#
# Optional
# Default: 200
#
# MaxIdleConnsPerHost = 200

# If set to true invalid SSL certificates are accepted for backends.
# Note: This disables detection of man-in-the-middle attacks so should only be used on secure backend networks.
# Optional
# Default: false
#
# InsecureSkipVerify = true

# Entrypoints to be used by frontends that do not specify any entrypoint.
# Each frontend can specify its own entrypoints.
#
# Optional
# Default: [&quot;http&quot;]
#
# defaultEntryPoints = [&quot;http&quot;, &quot;https&quot;]
</code></pre>

<h3 id="constraints">Constraints</h3>
<p>In a micro-service architecture, with a central service discovery, setting constraints limits Træfik scope to a smaller number of routes.</p>
<p>Træfik filters services according to service attributes/tags set in your configuration backends.</p>
<p>Supported backends:</p>
<ul>
<li>Docker</li>
<li>Consul K/V</li>
<li>BoltDB</li>
<li>Zookeeper</li>
<li>Etcd</li>
<li>Consul Catalog</li>
<li>Rancher</li>
</ul>
<p>Supported filters:</p>
<ul>
<li><code>tag</code></li>
</ul>
<pre><code class="toml"># Constraints definition
#
# Optional
#
# Simple matching constraint
# constraints = [&quot;tag==api&quot;]
#
# Simple mismatching constraint
# constraints = [&quot;tag!=api&quot;]
#
# Globbing
# constraints = [&quot;tag==us-*&quot;]
#
# Backend-specific constraint
# [consulCatalog]
#   endpoint = 127.0.0.1:8500
#   constraints = [&quot;tag==api&quot;]
#
# Multiple constraints
#   - &quot;tag==&quot; must match with at least one tag
#   - &quot;tag!=&quot; must match with none of tags
# constraints = [&quot;tag!=us-*&quot;, &quot;tag!=asia-*&quot;]
# [consulCatalog]
#   endpoint = 127.0.0.1:8500
#   constraints = [&quot;tag==api&quot;, &quot;tag!=v*-beta&quot;]
</code></pre>

<h2 id="entrypoints-definition">Entrypoints definition</h2>
<pre><code class="toml"># Entrypoints definition
#
# Optional
# Default:
# [entryPoints]
#   [entryPoints.http]
#   address = &quot;:80&quot;
#
# To redirect an http entrypoint to an https entrypoint (with SNI support):
# [entryPoints]
#   [entryPoints.http]
#   address = &quot;:80&quot;
#     [entryPoints.http.redirect]
#       entryPoint = &quot;https&quot;
#   [entryPoints.https]
#   address = &quot;:443&quot;
#     [entryPoints.https.tls]
#       [[entryPoints.https.tls.certificates]]
#       CertFile = &quot;integration/fixtures/https/snitest.com.cert&quot;
#       KeyFile = &quot;integration/fixtures/https/snitest.com.key&quot;
#       [[entryPoints.https.tls.certificates]]
#       CertFile = &quot;integration/fixtures/https/snitest.org.cert&quot;
#       KeyFile = &quot;integration/fixtures/https/snitest.org.key&quot;
#
# To redirect an entrypoint rewriting the URL:
# [entryPoints]
#   [entryPoints.http]
#   address = &quot;:80&quot;
#     [entryPoints.http.redirect]
#       regex = &quot;^http://localhost/(.*)&quot;
#       replacement = &quot;http://mydomain/$1&quot;
#
# Only accept clients that present a certificate signed by a specified
# Certificate Authority (CA)
# ClientCAFiles can be configured with multiple CA:s in the same file or
# use multiple files containing one or several CA:s. The CA:s has to be in PEM format.
# All clients will be required to present a valid cert.
# The requirement will apply to all server certs in the entrypoint
# In the example below both snitest.com and snitest.org will require client certs
#
# [entryPoints]
#   [entryPoints.https]
#   address = &quot;:443&quot;
#   [entryPoints.https.tls]
#   ClientCAFiles = [&quot;tests/clientca1.crt&quot;, &quot;tests/clientca2.crt&quot;]
#     [[entryPoints.https.tls.certificates]]
#     CertFile = &quot;integration/fixtures/https/snitest.com.cert&quot;
#     KeyFile = &quot;integration/fixtures/https/snitest.com.key&quot;
#     [[entryPoints.https.tls.certificates]]
#     CertFile = &quot;integration/fixtures/https/snitest.org.cert&quot;
#     KeyFile = &quot;integration/fixtures/https/snitest.org.key&quot;
#
# To enable basic auth on an entrypoint
# with 2 user/pass: test:test and test2:test2
# Passwords can be encoded in MD5, SHA1 and BCrypt: you can use htpasswd to generate those ones
# Users can be specified directly in the toml file, or indirectly by referencing an external file; if both are provided, the two are merged, with external file contents having precedence
# [entryPoints]
#   [entryPoints.http]
#   address = &quot;:80&quot;
#   [entryPoints.http.auth.basic]
#   users = [&quot;test:$apr1$H6uskkkW$IgXLP6ewTrSuBkTrqE8wj/&quot;, &quot;test2:$apr1$d9hr9HBB$4HxwgUir3HP4EsggP/QNo0&quot;]
#   usersFile = &quot;/path/to/.htpasswd&quot;
#
# To enable digest auth on an entrypoint
# with 2 user/realm/pass: test:traefik:test and test2:traefik:test2
# You can use htdigest to generate those ones
# Users can be specified directly in the toml file, or indirectly by referencing an external file; if both are provided, the two are merged, with external file contents having precedence
# [entryPoints]
#   [entryPoints.http]
#   address = &quot;:80&quot;
#   [entryPoints.http.auth.basic]
#   users = [&quot;test:traefik:a2688e031edb4be6a3797f3882655c05 &quot;, &quot;test2:traefik:518845800f9e2bfb1f1f740ec24f074e&quot;]
#   usersFile = &quot;/path/to/.htdigest&quot;
#
# To specify an https entrypoint with a minimum TLS version, and specifying an array of cipher suites (from crypto/tls):
# [entryPoints]
#   [entryPoints.https]
#   address = &quot;:443&quot;
#     [entryPoints.https.tls]
#     MinVersion = &quot;VersionTLS12&quot;
#     CipherSuites = [&quot;TLS_RSA_WITH_AES_256_GCM_SHA384&quot;]
#       [[entryPoints.https.tls.certificates]]
#       CertFile = &quot;integration/fixtures/https/snitest.com.cert&quot;
#       KeyFile = &quot;integration/fixtures/https/snitest.com.key&quot;
#       [[entryPoints.https.tls.certificates]]
#       CertFile = &quot;integration/fixtures/https/snitest.org.cert&quot;
#       KeyFile = &quot;integration/fixtures/https/snitest.org.key&quot;

# To enable compression support using gzip format:
# [entryPoints]
#   [entryPoints.http]
#   address = &quot;:80&quot;
#   compress = true

[entryPoints]
  [entryPoints.http]
  address = &quot;:80&quot;
</code></pre>

<h2 id="retry-configuration">Retry configuration</h2>
<pre><code class="toml"># Enable retry sending request if network error
#
# Optional
#
[retry]

# Number of attempts
#
# Optional
# Default: (number servers in backend) -1
#
# attempts = 3
</code></pre>

<h2 id="health-check-configuration">Health check configuration</h2>
<pre><code class="toml"># Enable custom health check options.
#
# Optional
#
[healthcheck]

# Set the default health check interval. Will only be effective if health check
# paths are defined. Given provider-specific support, the value may be
# overridden on a per-backend basis.
# Can be provided in a format supported by [time.ParseDuration](https://golang.org/pkg/time/#ParseDuration) or as raw
# values (digits). If no units are provided, the value is parsed assuming
# seconds.
#
# Optional
# Default: &quot;30s&quot;
#
# interval = &quot;30s&quot;
</code></pre>

<h2 id="acme-lets-encrypt-configuration">ACME (Let's Encrypt) configuration</h2>
<pre><code class="toml"># Sample entrypoint configuration when using ACME
[entryPoints]
  [entryPoints.https]
  address = &quot;:443&quot;
    [entryPoints.https.tls]

# Enable ACME (Let's Encrypt): automatic SSL
#
# Optional
#
[acme]

# Email address used for registration
#
# Required
#
email = &quot;test@traefik.io&quot;

# File or key used for certificates storage.
# WARNING, if you use Traefik in Docker, you have 2 options:
#  - create a file on your host and mount it as a volume
#      storageFile = &quot;acme.json&quot;
#      $ docker run -v &quot;/my/host/acme.json:acme.json&quot; traefik
#  - mount the folder containing the file as a volume
#      storageFile = &quot;/etc/traefik/acme/acme.json&quot;
#      $ docker run -v &quot;/my/host/acme:/etc/traefik/acme&quot; traefik
#
# Required
#
storage = &quot;acme.json&quot; # or &quot;traefik/acme/account&quot; if using KV store

# Entrypoint to proxy acme challenge/apply certificates to.
# WARNING, must point to an entrypoint on port 443
#
# Required
#
entryPoint = &quot;https&quot;

# Use a DNS based acme challenge rather than external HTTPS access, e.g. for a firewalled server
# Select the provider that matches the DNS domain that will host the challenge TXT record,
# and provide environment variables with access keys to enable setting it:
#  - cloudflare: CLOUDFLARE_EMAIL, CLOUDFLARE_API_KEY
#  - digitalocean: DO_AUTH_TOKEN
#  - dnsimple: DNSIMPLE_EMAIL, DNSIMPLE_API_KEY
#  - dnsmadeeasy: DNSMADEEASY_API_KEY, DNSMADEEASY_API_SECRET
#  - exoscale: EXOSCALE_API_KEY, EXOSCALE_API_SECRET
#  - gandi: GANDI_API_KEY
#  - linode: LINODE_API_KEY
#  - manual: none, but run traefik interactively &amp; turn on acmeLogging to see instructions &amp; press Enter
#  - namecheap: NAMECHEAP_API_USER, NAMECHEAP_API_KEY
#  - rfc2136: RFC2136_TSIG_KEY, RFC2136_TSIG_SECRET, RFC2136_TSIG_ALGORITHM, RFC2136_NAMESERVER
#  - route53: AWS_ACCESS_KEY_ID, AWS_SECRET_ACCESS_KEY, AWS_REGION, or configured user/instance IAM profile
#  - dyn: DYN_CUSTOMER_NAME, DYN_USER_NAME, DYN_PASSWORD
#  - vultr: VULTR_API_KEY
#  - ovh: OVH_ENDPOINT, OVH_APPLICATION_KEY, OVH_APPLICATION_SECRET, OVH_CONSUMER_KEY
#  - pdns: PDNS_API_KEY, PDNS_API_URL
#
# Optional
#
# dnsProvider = &quot;digitalocean&quot;

# By default, the dnsProvider will verify the TXT DNS challenge record before letting ACME verify
# If delayDontCheckDNS is greater than zero, avoid this &amp; instead just wait so many seconds.
# Useful if internal networks block external DNS queries
#
# Optional
#
# delayDontCheckDNS = 0

# If true, display debug log messages from the acme client library
#
# Optional
#
# acmeLogging = true

# Enable on demand certificate. This will request a certificate from Let's Encrypt during the first TLS handshake for a hostname that does not yet have a certificate.
# WARNING, TLS handshakes will be slow when requesting a hostname certificate for the first time, this can leads to DoS attacks.
# WARNING, Take note that Let's Encrypt have rate limiting: https://letsencrypt.org/docs/rate-limits
#
# Optional
#
# onDemand = true

# Enable certificate generation on frontends Host rules. This will request a certificate from Let's Encrypt for each frontend with a Host rule.
# For example, a rule Host:test1.traefik.io,test2.traefik.io will request a certificate with main domain test1.traefik.io and SAN test2.traefik.io.
#
# Optional
#
# OnHostRule = true

# CA server to use
# Uncomment the line to run on the staging let's encrypt server
# Leave comment to go to prod
#
# Optional
#
# caServer = &quot;https://acme-staging.api.letsencrypt.org/directory&quot;

# Domains list
# You can provide SANs (alternative domains) to each main domain
# All domains must have A/AAAA records pointing to Traefik
# WARNING, Take note that Let's Encrypt have rate limiting: https://letsencrypt.org/docs/rate-limits
# Each domain &amp; SANs will lead to a certificate request.
#
# [[acme.domains]]
#   main = &quot;local1.com&quot;
#   sans = [&quot;test1.local1.com&quot;, &quot;test2.local1.com&quot;]
# [[acme.domains]]
#   main = &quot;local2.com&quot;
#   sans = [&quot;test1.local2.com&quot;, &quot;test2x.local2.com&quot;]
# [[acme.domains]]
#   main = &quot;local3.com&quot;
# [[acme.domains]]
#   main = &quot;local4.com&quot;
[[acme.domains]]
   main = &quot;local1.com&quot;
   sans = [&quot;test1.local1.com&quot;, &quot;test2.local1.com&quot;]
[[acme.domains]]
   main = &quot;local3.com&quot;
[[acme.domains]]
   main = &quot;local4.com&quot;
</code></pre>

<h1 id="configuration-backends">Configuration backends</h1>
<h2 id="file-backend">File backend</h2>
<p>Like any other reverse proxy, Træfik can be configured with a file. You have two choices:</p>
<ul>
<li>simply add your configuration at the end of the global configuration file <code>traefik.toml</code>:</li>
</ul>
<pre><code class="toml"># traefik.toml
logLevel = &quot;DEBUG&quot;
defaultEntryPoints = [&quot;http&quot;, &quot;https&quot;]
[entryPoints]
  [entryPoints.http]
  address = &quot;:80&quot;
    [entryPoints.http.redirect]
      entryPoint = &quot;https&quot;
  [entryPoints.https]
  address = &quot;:443&quot;
    [entryPoints.https.tls]
      [[entryPoints.https.tls.certificates]]
      CertFile = &quot;integration/fixtures/https/snitest.com.cert&quot;
      KeyFile = &quot;integration/fixtures/https/snitest.com.key&quot;
      [[entryPoints.https.tls.certificates]]
      CertFile = &quot;integration/fixtures/https/snitest.org.cert&quot;
      KeyFile = &quot;integration/fixtures/https/snitest.org.key&quot;

[file]

# rules
[backends]
  [backends.backend1]
    [backends.backend1.circuitbreaker]
      expression = &quot;NetworkErrorRatio() &gt; 0.5&quot;
    [backends.backend1.servers.server1]
    url = &quot;http://172.17.0.2:80&quot;
    weight = 10
    [backends.backend1.servers.server2]
    url = &quot;http://172.17.0.3:80&quot;
    weight = 1
  [backends.backend2]
    [backends.backend1.maxconn]
      amount = 10
      extractorfunc = &quot;request.host&quot;
    [backends.backend2.LoadBalancer]
      method = &quot;drr&quot;
    [backends.backend2.servers.server1]
    url = &quot;http://172.17.0.4:80&quot;
    weight = 1
    [backends.backend2.servers.server2]
    url = &quot;http://172.17.0.5:80&quot;
    weight = 2

[frontends]
  [frontends.frontend1]
  backend = &quot;backend2&quot;
    [frontends.frontend1.routes.test_1]
    rule = &quot;Host:test.localhost&quot;
  [frontends.frontend2]
  backend = &quot;backend1&quot;
  passHostHeader = true
  priority = 10
  entrypoints = [&quot;https&quot;] # overrides defaultEntryPoints
    [frontends.frontend2.routes.test_1]
    rule = &quot;Host:{subdomain:[a-z]+}.localhost&quot;
  [frontends.frontend3]
  entrypoints = [&quot;http&quot;, &quot;https&quot;] # overrides defaultEntryPoints
  backend = &quot;backend2&quot;
    rule = &quot;Path:/test&quot;
</code></pre>

<ul>
<li>or put your rules in a separate file, for example <code>rules.toml</code>:</li>
</ul>
<pre><code class="toml"># traefik.toml
logLevel = &quot;DEBUG&quot;
[entryPoints]
  [entryPoints.http]
  address = &quot;:80&quot;
    [entryPoints.http.redirect]
      entryPoint = &quot;https&quot;
  [entryPoints.https]
  address = &quot;:443&quot;
    [entryPoints.https.tls]
      [[entryPoints.https.tls.certificates]]
      CertFile = &quot;integration/fixtures/https/snitest.com.cert&quot;
      KeyFile = &quot;integration/fixtures/https/snitest.com.key&quot;
      [[entryPoints.https.tls.certificates]]
      CertFile = &quot;integration/fixtures/https/snitest.org.cert&quot;
      KeyFile = &quot;integration/fixtures/https/snitest.org.key&quot;

[file]
filename = &quot;rules.toml&quot;
</code></pre>

<pre><code class="toml"># rules.toml
[backends]
  [backends.backend1]
    [backends.backend1.circuitbreaker]
      expression = &quot;NetworkErrorRatio() &gt; 0.5&quot;
    [backends.backend1.servers.server1]
    url = &quot;http://172.17.0.2:80&quot;
    weight = 10
    [backends.backend1.servers.server2]
    url = &quot;http://172.17.0.3:80&quot;
    weight = 1
  [backends.backend2]
    [backends.backend1.maxconn]
      amount = 10
      extractorfunc = &quot;request.host&quot;
    [backends.backend2.LoadBalancer]
      method = &quot;drr&quot;
    [backends.backend2.servers.server1]
    url = &quot;http://172.17.0.4:80&quot;
    weight = 1
    [backends.backend2.servers.server2]
    url = &quot;http://172.17.0.5:80&quot;
    weight = 2

[frontends]
  [frontends.frontend1]
  backend = &quot;backend2&quot;
    [frontends.frontend1.routes.test_1]
    rule = &quot;Host:test.localhost&quot;
  [frontends.frontend2]
  backend = &quot;backend1&quot;
  passHostHeader = true
  priority = 10
  entrypoints = [&quot;https&quot;] # overrides defaultEntryPoints
    [frontends.frontend2.routes.test_1]
    rule = &quot;Host:{subdomain:[a-z]+}.localhost&quot;
  [frontends.frontend3]
  entrypoints = [&quot;http&quot;, &quot;https&quot;] # overrides defaultEntryPoints
  backend = &quot;backend2&quot;
    rule = &quot;Path:/test&quot;
</code></pre>

<p>If you want Træfik to watch file changes automatically, just add:</p>
<pre><code class="toml">[file]
watch = true
</code></pre>

<h2 id="api-backend">API backend</h2>
<p>Træfik can be configured using a RESTful api.
To enable it:</p>
<pre><code class="toml">[web]
address = &quot;:8080&quot;

# Set the root path for webui and API
#
# Optional
#
# path = &quot;/mypath&quot;
#
# SSL certificate and key used
#
# Optional
#
# CertFile = &quot;traefik.crt&quot;
# KeyFile = &quot;traefik.key&quot;
#
# Set REST API to read-only mode
#
# Optional
# ReadOnly = false
#
# To enable more detailed statistics
# [web.statistics]
#   RecentErrors = 10
#
# To enable Traefik to export internal metrics to Prometheus
# [web.metrics.prometheus]
#   Buckets=[0.1,0.3,1.2,5.0]
#
# To enable basic auth on the webui
# with 2 user/pass: test:test and test2:test2
# Passwords can be encoded in MD5, SHA1 and BCrypt: you can use htpasswd to generate those ones
# Users can be specified directly in the toml file, or indirectly by referencing an external file; if both are provided, the two are merged, with external file contents having precedence
#   [web.auth.basic]
#     users = [&quot;test:$apr1$H6uskkkW$IgXLP6ewTrSuBkTrqE8wj/&quot;, &quot;test2:$apr1$d9hr9HBB$4HxwgUir3HP4EsggP/QNo0&quot;]
#     usersFile = &quot;/path/to/.htpasswd&quot;
# To enable digest auth on the webui
# with 2 user/realm/pass: test:traefik:test and test2:traefik:test2
# You can use htdigest to generate those ones
# Users can be specified directly in the toml file, or indirectly by referencing an external file; if both are provided, the two are merged, with external file contents having precedence
#   [web.auth.digest]
#     users = [&quot;test:traefik:a2688e031edb4be6a3797f3882655c05 &quot;, &quot;test2:traefik:518845800f9e2bfb1f1f740ec24f074e&quot;]
#     usersFile = &quot;/path/to/.htdigest&quot;
</code></pre>

<ul>
<li><code>/</code>: provides a simple HTML frontend of Træfik</li>
</ul>
<p><img alt="Web UI Providers" src="../img/web.frontend.png" />
<img alt="Web UI Health" src="../img/traefik-health.png" /></p>
<ul>
<li><code>/ping</code>: <code>GET</code> simple endpoint to check for Træfik process liveness.</li>
</ul>
<pre><code class="shell">$ curl -sv &quot;http://localhost:8080/ping&quot;
*   Trying ::1...
* Connected to localhost (::1) port 8080 (#0)
&gt; GET /ping HTTP/1.1
&gt; Host: localhost:8080
&gt; User-Agent: curl/7.43.0
&gt; Accept: */*
&gt;
&lt; HTTP/1.1 200 OK
&lt; Date: Thu, 25 Aug 2016 01:35:36 GMT
&lt; Content-Length: 2
&lt; Content-Type: text/plain; charset=utf-8
&lt;
* Connection #0 to host localhost left intact
OK
</code></pre>

<ul>
<li><code>/health</code>: <code>GET</code> json metrics</li>
</ul>
<pre><code class="shell">$ curl -s &quot;http://localhost:8080/health&quot; | jq .
{
  // Træfik PID
  &quot;pid&quot;: 2458,
  // Træfik server uptime (formated time)
  &quot;uptime&quot;: &quot;39m6.885931127s&quot;,
  //  Træfik server uptime in seconds
  &quot;uptime_sec&quot;: 2346.885931127,
  // current server date
  &quot;time&quot;: &quot;2015-10-07 18:32:24.362238909 +0200 CEST&quot;,
  // current server date in seconds
  &quot;unixtime&quot;: 1444235544,
  // count HTTP response status code in realtime
  &quot;status_code_count&quot;: {
    &quot;502&quot;: 1
  },
  // count HTTP response status code since Træfik started
  &quot;total_status_code_count&quot;: {
    &quot;200&quot;: 7,
    &quot;404&quot;: 21,
    &quot;502&quot;: 13
  },
  // count HTTP response
  &quot;count&quot;: 1,
  // count HTTP response
  &quot;total_count&quot;: 41,
  // sum of all response time (formated time)
  &quot;total_response_time&quot;: &quot;35.456865605s&quot;,
  // sum of all response time in seconds
  &quot;total_response_time_sec&quot;: 35.456865605,
  // average response time (formated time)
  &quot;average_response_time&quot;: &quot;864.8016ms&quot;,
  // average response time in seconds
  &quot;average_response_time_sec&quot;: 0.8648016000000001,

  // request statistics [requires --web.statistics to be set]
  // ten most recent requests with 4xx and 5xx status codes
  &quot;recent_errors&quot;: [
    {
      // status code
      &quot;status_code&quot;: 500,
      // description of status code
      &quot;status&quot;: &quot;Internal Server Error&quot;,
      // request HTTP method
      &quot;method&quot;: &quot;GET&quot;,
      // request hostname
      &quot;host&quot;: &quot;localhost&quot;,
      // request path
      &quot;path&quot;: &quot;/path&quot;,
      // RFC 3339 formatted date/time
      &quot;time&quot;: &quot;2016-10-21T16:59:15.418495872-07:00&quot;
    }
  ]
}
</code></pre>

<ul>
<li><code>/api</code>: <code>GET</code> configuration for all providers</li>
</ul>
<pre><code class="shell">$ curl -s &quot;http://localhost:8080/api&quot; | jq .
{
  &quot;file&quot;: {
    &quot;frontends&quot;: {
      &quot;frontend2&quot;: {
        &quot;routes&quot;: {
          &quot;test_2&quot;: {
            &quot;rule&quot;: &quot;Path:/test&quot;
          }
        },
        &quot;backend&quot;: &quot;backend1&quot;
      },
      &quot;frontend1&quot;: {
        &quot;routes&quot;: {
          &quot;test_1&quot;: {
            &quot;rule&quot;: &quot;Host:test.localhost&quot;
          }
        },
        &quot;backend&quot;: &quot;backend2&quot;
      }
    },
    &quot;backends&quot;: {
      &quot;backend2&quot;: {
        &quot;loadBalancer&quot;: {
          &quot;method&quot;: &quot;drr&quot;
        },
        &quot;servers&quot;: {
          &quot;server2&quot;: {
            &quot;weight&quot;: 2,
            &quot;URL&quot;: &quot;http://172.17.0.5:80&quot;
          },
          &quot;server1&quot;: {
            &quot;weight&quot;: 1,
            &quot;url&quot;: &quot;http://172.17.0.4:80&quot;
          }
        }
      },
      &quot;backend1&quot;: {
        &quot;loadBalancer&quot;: {
          &quot;method&quot;: &quot;wrr&quot;
        },
        &quot;circuitBreaker&quot;: {
          &quot;expression&quot;: &quot;NetworkErrorRatio() &gt; 0.5&quot;
        },
        &quot;servers&quot;: {
          &quot;server2&quot;: {
            &quot;weight&quot;: 1,
            &quot;url&quot;: &quot;http://172.17.0.3:80&quot;
          },
          &quot;server1&quot;: {
            &quot;weight&quot;: 10,
            &quot;url&quot;: &quot;http://172.17.0.2:80&quot;
          }
        }
      }
    }
  }
}
</code></pre>

<ul>
<li><code>/api/providers</code>: <code>GET</code> providers</li>
<li><code>/api/providers/{provider}</code>: <code>GET</code> or <code>PUT</code> provider</li>
<li><code>/api/providers/{provider}/backends</code>: <code>GET</code> backends</li>
<li><code>/api/providers/{provider}/backends/{backend}</code>: <code>GET</code> a backend</li>
<li><code>/api/providers/{provider}/backends/{backend}/servers</code>: <code>GET</code> servers in a backend</li>
<li><code>/api/providers/{provider}/backends/{backend}/servers/{server}</code>: <code>GET</code> a server in a backend</li>
<li><code>/api/providers/{provider}/frontends</code>: <code>GET</code> frontends</li>
<li><code>/api/providers/{provider}/frontends/{frontend}</code>: <code>GET</code> a frontend</li>
<li><code>/api/providers/{provider}/frontends/{frontend}/routes</code>: <code>GET</code> routes in a frontend</li>
<li>
<p><code>/api/providers/{provider}/frontends/{frontend}/routes/{route}</code>: <code>GET</code> a route in a frontend</p>
</li>
<li>
<p><code>/metrics</code>: You can enable Traefik to export internal metrics to different monitoring systems (Only Prometheus is supported at the moment).</p>
</li>
</ul>
<pre><code class="bash">$ traefik --web.metrics.prometheus --web.metrics.prometheus.buckets=&quot;0.1,0.3,1.2,5.0&quot;
</code></pre>

<h2 id="docker-backend">Docker backend</h2>
<p>Træfik can be configured to use Docker as a backend configuration:</p>
<pre><code class="toml">################################################################
# Docker configuration backend
################################################################

# Enable Docker configuration backend
#
# Optional
#
[docker]

# Docker server endpoint. Can be a tcp or a unix socket endpoint.
#
# Required
#
endpoint = &quot;unix:///var/run/docker.sock&quot;

# Default domain used.
# Can be overridden by setting the &quot;traefik.domain&quot; label on a container.
#
# Required
#
domain = &quot;docker.localhost&quot;

# Enable watch docker changes
#
# Optional
#
watch = true

# Override default configuration template. For advanced users :)
#
# Optional
#
# filename = &quot;docker.tmpl&quot;

# Expose containers by default in traefik
# If set to false, containers that don't have `traefik.enable=true` will be ignored
#
# Optional
# Default: true
#
exposedbydefault = true

# Use the IP address from the binded port instead of the inner network one. For specific use-case :)

#
# Optional
# Default: false
#
usebindportip = true
# Use Swarm Mode services as data provider
#
# Optional
# Default: false
#
swarmmode = false


# Enable docker TLS connection
#
#  [docker.tls]
#  ca = &quot;/etc/ssl/ca.crt&quot;
#  cert = &quot;/etc/ssl/docker.crt&quot;
#  key = &quot;/etc/ssl/docker.key&quot;
#  insecureskipverify = true
</code></pre>

<p>Labels can be used on containers to override default behaviour:</p>
<ul>
<li><code>traefik.backend=foo</code>: give the name <code>backend-foo</code> to the generated backend for this container.</li>
<li><code>traefik.backend.maxconn.amount=10</code>: set a maximum number of connections to the backend. Must be used in conjunction with the below label to take effect.</li>
<li><code>traefik.backend.maxconn.extractorfunc=client.ip</code>: set the function to be used against the request to determine what to limit maximum connections to the backend by. Must be used in conjunction with the above label to take effect.</li>
<li><code>traefik.backend.loadbalancer.method=drr</code>: override the default <code>wrr</code> load balancer algorithm</li>
<li><code>traefik.backend.loadbalancer.sticky=true</code>: enable backend sticky sessions</li>
<li><code>traefik.backend.loadbalancer.swarm=true</code>: use Swarm's inbuilt load balancer (only relevant under Swarm Mode).</li>
<li><code>traefik.backend.circuitbreaker.expression=NetworkErrorRatio() &gt; 0.5</code>: create a <a href="../basics/#backends">circuit breaker</a> to be used against the backend</li>
<li><code>traefik.port=80</code>: register this port. Useful when the container exposes multiples ports.</li>
<li><code>traefik.protocol=https</code>: override the default <code>http</code> protocol</li>
<li><code>traefik.weight=10</code>: assign this weight to the container</li>
<li><code>traefik.enable=false</code>: disable this container in Træfik</li>
<li><code>traefik.frontend.rule=Host:test.traefik.io</code>: override the default frontend rule (Default: <code>Host:{containerName}.{domain}</code> or <code>Host:{service}.{project_name}.{domain}</code> if you are using <code>docker-compose</code>).</li>
<li><code>traefik.frontend.passHostHeader=true</code>: forward client <code>Host</code> header to the backend.</li>
<li><code>traefik.frontend.priority=10</code>: override default frontend priority</li>
<li><code>traefik.frontend.entryPoints=http,https</code>: assign this frontend to entry points <code>http</code> and <code>https</code>. Overrides <code>defaultEntryPoints</code>.</li>
<li><code>traefik.frontend.auth.basic=test:$apr1$H6uskkkW$IgXLP6ewTrSuBkTrqE8wj/,test2:$apr1$d9hr9HBB$4HxwgUir3HP4EsggP/QNo0</code>: Sets a Basic Auth for that frontend with the users test:test and test2:test2</li>
<li><code>traefik.docker.network</code>: Set the docker network to use for connections to this container. If a container is linked to several networks, be sure to set the proper network name (you can check with docker inspect <container_id>) otherwise it will randomly pick one (depending on how docker is returning them). For instance when deploying docker <code>stack</code> from compose files, the compose defined networks will be prefixed with the <code>stack</code> name.</li>
</ul>
<p>If several ports need to be exposed from a container, the services labels can be used
- <code>traefik.&lt;service-name&gt;.port=443</code>: create a service binding with frontend/backend using this port. Overrides <code>traefik.port</code>.
- <code>traefik.&lt;service-name&gt;.protocol=https</code>: assign <code>https</code> protocol. Overrides <code>traefik.protocol</code>.
- <code>traefik.&lt;service-name&gt;.weight=10</code>: assign this service weight. Overrides <code>traefik.weight</code>.
- <code>traefik.&lt;service-name&gt;.frontend.backend=fooBackend</code>: assign this service frontend to <code>foobackend</code>. Default is to assign to the service backend.
- <code>traefik.&lt;service-name&gt;.frontend.entryPoints=http</code>: assign this service entrypoints. Overrides <code>traefik.frontend.entrypoints</code>.
- <code>traefik.&lt;service-name&gt;.frontend.auth.basic=test:$apr1$H6uskkkW$IgXLP6ewTrSuBkTrqE8wj/,test2:$apr1$d9hr9HBB$4HxwgUir3HP4EsggP/QNo0</code> Sets a Basic Auth for that frontend with the users test:test and test2:test2.
- <code>traefik.&lt;service-name&gt;.frontend.passHostHeader=true</code>: Forward client <code>Host</code> header to the backend. Overrides <code>traefik.frontend.passHostHeader</code>.
- <code>traefik.&lt;service-name&gt;.frontend.priority=10</code>: assign the service frontend priority. Overrides <code>traefik.frontend.priority</code>.
- <code>traefik.&lt;service-name&gt;.frontend.rule=Path:/foo</code>: assign the service frontend rule. Overrides <code>traefik.frontend.rule</code>.</p>
<p>NB: when running inside a container, Træfik will need network access through <code>docker network connect &lt;network&gt; &lt;traefik-container&gt;</code></p>
<h2 id="marathon-backend">Marathon backend</h2>
<p>Træfik can be configured to use Marathon as a backend configuration:</p>
<pre><code class="toml">################################################################
# Mesos/Marathon configuration backend
################################################################

# Enable Marathon configuration backend
#
# Optional
#
[marathon]

# Marathon server endpoint.
# You can also specify multiple endpoint for Marathon:
# endpoint := &quot;http://10.241.1.71:8080,10.241.1.72:8080,10.241.1.73:8080&quot;
#
# Required
#
endpoint = &quot;http://127.0.0.1:8080&quot;

# Enable watch Marathon changes
#
# Optional
#
watch = true

# Default domain used.
#
# Required
#
domain = &quot;marathon.localhost&quot;

# Override default configuration template. For advanced users :)
#
# Optional
#
# filename = &quot;marathon.tmpl&quot;

# Expose Marathon apps by default in traefik
#
# Optional
# Default: true
#
# exposedByDefault = true

# Convert Marathon groups to subdomains
# Default behavior: /foo/bar/myapp =&gt; foo-bar-myapp.{defaultDomain}
# with groupsAsSubDomains enabled: /foo/bar/myapp =&gt; myapp.bar.foo.{defaultDomain}
#
# Optional
# Default: false
#
# groupsAsSubDomains = true

# Enable compatibility with marathon-lb labels
#
# Optional
# Default: false
#
# marathonLBCompatibility = true

# Enable Marathon basic authentication
#
# Optional
#
#  [marathon.basic]
#  httpBasicAuthUser = &quot;foo&quot;
#  httpBasicPassword = &quot;bar&quot;

# TLS client configuration. https://golang.org/pkg/crypto/tls/#Config
#
# Optional
#
# [marathon.TLS]
# CA = &quot;/etc/ssl/ca.crt&quot;
# Cert = &quot;/etc/ssl/marathon.cert&quot;
# Key = &quot;/etc/ssl/marathon.key&quot;
# InsecureSkipVerify = true

# DCOSToken for DCOS environment, This will override the Authorization header
#
# Optional
#
# dcosToken = &quot;xxxxxx&quot;

# Override DialerTimeout
# Amount of time to allow the Marathon provider to wait to open a TCP connection
# to a Marathon master.
# Can be provided in a format supported by [time.ParseDuration](https://golang.org/pkg/time/#ParseDuration) or as raw
# values (digits). If no units are provided, the value is parsed assuming
# seconds.
#
# Optional
# Default: &quot;60s&quot;
# dialerTimeout = &quot;60s&quot;

# Set the TCP Keep Alive interval for the Marathon HTTP Client.
# Can be provided in a format supported by [time.ParseDuration](https://golang.org/pkg/time/#ParseDuration) or as raw
# values (digits). If no units are provided, the value is parsed assuming
# seconds.
#
# Optional
# Default: &quot;10s&quot;
#
# keepAlive = &quot;10s&quot;

# By default, a task's IP address (as returned by the Marathon API) is used as 
# backend server if an IP-per-task configuration can be found; otherwise, the
# name of the host running the task is used.
# The latter behavior can be enforced by enabling this switch.
# 
# Optional
# Default: false
#
# forceTaskHostname: false 
</code></pre>

<p>Labels can be used on containers to override default behaviour:</p>
<ul>
<li><code>traefik.backend=foo</code>: assign the application to <code>foo</code> backend</li>
<li><code>traefik.backend.maxconn.amount=10</code>: set a maximum number of connections to the backend. Must be used in conjunction with the below label to take effect.</li>
<li><code>traefik.backend.maxconn.extractorfunc=client.ip</code>: set the function to be used against the request to determine what to limit maximum connections to the backend by. Must be used in conjunction with the above label to take effect.</li>
<li><code>traefik.backend.loadbalancer.method=drr</code>: override the default <code>wrr</code> load balancer algorithm</li>
<li><code>traefik.backend.loadbalancer.sticky=true</code>: enable backend sticky sessions</li>
<li><code>traefik.backend.circuitbreaker.expression=NetworkErrorRatio() &gt; 0.5</code>: create a <a href="../basics/#backends">circuit breaker</a> to be used against the backend</li>
<li><code>traefik.backend.healthcheck.path=/health</code>: set the Traefik health check path [default: no health checks]</li>
<li><code>traefik.backend.healthcheck.interval=5s</code>: sets a custom health check interval in Go-parseable (<code>time.ParseDuration</code>) format [default: 30s]</li>
<li><code>traefik.portIndex=1</code>: register port by index in the application's ports array. Useful when the application exposes multiple ports.</li>
<li><code>traefik.port=80</code>: register the explicit application port value. Cannot be used alongside <code>traefik.portIndex</code>.</li>
<li><code>traefik.protocol=https</code>: override the default <code>http</code> protocol</li>
<li><code>traefik.weight=10</code>: assign this weight to the application</li>
<li><code>traefik.enable=false</code>: disable this application in Træfik</li>
<li><code>traefik.frontend.rule=Host:test.traefik.io</code>: override the default frontend rule (Default: <code>Host:{containerName}.{domain}</code>).</li>
<li><code>traefik.frontend.passHostHeader=true</code>: forward client <code>Host</code> header to the backend.</li>
<li><code>traefik.frontend.priority=10</code>: override default frontend priority</li>
<li><code>traefik.frontend.entryPoints=http,https</code>: assign this frontend to entry points <code>http</code> and <code>https</code>. Overrides <code>defaultEntryPoints</code>.</li>
</ul>
<h2 id="mesos-generic-backend">Mesos generic backend</h2>
<p>Træfik can be configured to use Mesos as a backend configuration:</p>
<pre><code class="toml">################################################################
# Mesos configuration backend
################################################################

# Enable Mesos configuration backend
#
# Optional
#
[mesos]

# Mesos server endpoint.
# You can also specify multiple endpoint for Mesos:
# endpoint = &quot;192.168.35.40:5050,192.168.35.41:5050,192.168.35.42:5050&quot;
# endpoint = &quot;zk://192.168.35.20:2181,192.168.35.21:2181,192.168.35.22:2181/mesos&quot;
#
# Required
#
endpoint = &quot;http://127.0.0.1:8080&quot;

# Enable watch Mesos changes
#
# Optional
#
watch = true

# Default domain used.
# Can be overridden by setting the &quot;traefik.domain&quot; label on an application.
#
# Required
#
domain = &quot;mesos.localhost&quot;

# Override default configuration template. For advanced users :)
#
# Optional
#
# filename = &quot;mesos.tmpl&quot;

# Expose Mesos apps by default in traefik
#
# Optional
# Default: false
#
# ExposedByDefault = true

# TLS client configuration. https://golang.org/pkg/crypto/tls/#Config
#
# Optional
#
# [mesos.TLS]
# InsecureSkipVerify = true

# Zookeeper timeout (in seconds)
#
# Optional
# Default: 30
#
# ZkDetectionTimeout = 30

# Polling interval (in seconds)
#
# Optional
# Default: 30
#
# RefreshSeconds = 30

# IP sources (e.g. host, docker, mesos, rkt)
#
# Optional
#
# IPSources = &quot;host&quot;

# HTTP Timeout (in seconds)
#
# Optional
# Default: 30
#
# StateTimeoutSecond = &quot;30&quot;
</code></pre>

<h2 id="kubernetes-ingress-backend">Kubernetes Ingress backend</h2>
<p>Træfik can be configured to use Kubernetes Ingress as a backend configuration:</p>
<pre><code class="toml">################################################################
# Kubernetes Ingress configuration backend
################################################################
# Enable Kubernetes Ingress configuration backend
#
# Optional
#
[kubernetes]

# Kubernetes server endpoint
#
# When deployed as a replication controller in Kubernetes, Traefik will use
# the environment variables KUBERNETES_SERVICE_HOST and KUBERNETES_SERVICE_PORT
# to construct the endpoint.
# Secure token will be found in /var/run/secrets/kubernetes.io/serviceaccount/token
# and SSL CA cert in /var/run/secrets/kubernetes.io/serviceaccount/ca.crt
#
# The endpoint may be given to override the environment variable values.
#
# When the environment variables are not found, Traefik will try to connect to
# the Kubernetes API server with an external-cluster client. In this case, the
# endpoint is required. Specifically, it may be set to the URL used by
# `kubectl proxy` to connect to a Kubernetes cluster from localhost.
#
# Optional for in-cluster configuration, required otherwise
# Default: empty
#
# endpoint = &quot;http://localhost:8080&quot;

# Bearer token used for the Kubernetes client configuration.
#
# Optional
# Default: empty
#
# token = &quot;my token&quot;

# Path to the certificate authority file used for the Kubernetes client
# configuration.
#
# Optional
# Default: empty
#
# certAuthFilePath = &quot;/my/ca.crt&quot;

# Array of namespaces to watch.
#
# Optional
# Default: [&quot;default&quot;].
#
# namespaces = [&quot;default&quot;, &quot;production&quot;]

# See: http://kubernetes.io/docs/user-guide/labels/#list-and-watch-filtering
# labelselector = &quot;A and not B&quot;
#
</code></pre>

<p>Annotations can be used on containers to override default behaviour for the whole Ingress resource:</p>
<ul>
<li><code>traefik.frontend.rule.type: PathPrefixStrip</code>: override the default frontend rule type (Default: <code>PathPrefix</code>).</li>
</ul>
<p>Annotations can be used on the Kubernetes service to override default behaviour:</p>
<ul>
<li><code>traefik.backend.loadbalancer.method=drr</code>: override the default <code>wrr</code> load balancer algorithm</li>
<li><code>traefik.backend.loadbalancer.sticky=true</code>: enable backend sticky sessions</li>
</ul>
<p>You can find here an example <a href="https://raw.githubusercontent.com/containous/traefik/master/examples/k8s/cheese-ingress.yaml">ingress</a> and <a href="https://raw.githubusercontent.com/containous/traefik/master/examples/k8s/traefik.yaml">replication controller</a>.</p>
<p>Additionally, an annotation can be used on Kubernetes services to set the <a href="https://docs.traefik.io/basics/#backends">circuit breaker expression</a> for a backend.</p>
<ul>
<li><code>traefik.backend.circuitbreaker: &lt;expression&gt;</code>: set the circuit breaker expression for the backend (Default: nil).</li>
</ul>
<h3 id="authentication">Authentication</h3>
<p>Is possible to add additional authentication annotations in the Ingress rule.
The source of the authentication is a secret that contains usernames and passwords inside the the key auth.</p>
<ul>
<li><code>ingress.kubernetes.io/auth-type</code>: <code>basic</code></li>
<li><code>ingress.kubernetes.io/auth-secret</code>: contains the usernames and passwords with access to the paths defined in the Ingress Rule.</li>
</ul>
<p>The secret must be created in the same namespace as the Ingress rule.</p>
<p>Limitations:</p>
<ul>
<li>Basic authentication only.</li>
<li>Realm not configurable; only <code>traefik</code> default.</li>
<li>Secret must contain only single file.</li>
</ul>
<h2 id="consul-backend">Consul backend</h2>
<p>Træfik can be configured to use Consul as a backend configuration:</p>
<pre><code class="toml">################################################################
# Consul KV configuration backend
################################################################

# Enable Consul KV configuration backend
#
# Optional
#
[consul]

# Consul server endpoint
#
# Required
#
endpoint = &quot;127.0.0.1:8500&quot;

# Enable watch Consul changes
#
# Optional
#
watch = true

# Prefix used for KV store.
#
# Optional
#
prefix = &quot;traefik&quot;

# Override default configuration template. For advanced users :)
#
# Optional
#
# filename = &quot;consul.tmpl&quot;

# Enable consul TLS connection
#
# Optional
#
# [consul.tls]
# ca = &quot;/etc/ssl/ca.crt&quot;
# cert = &quot;/etc/ssl/consul.crt&quot;
# key = &quot;/etc/ssl/consul.key&quot;
# insecureskipverify = true
</code></pre>

<p>Please refer to the <a href="../user-guide/kv-config/#key-value-storage-structure">Key Value storage structure</a> section to get documentation on traefik KV structure.</p>
<h2 id="consul-catalog-backend">Consul catalog backend</h2>
<p>Træfik can be configured to use service discovery catalog of Consul as a backend configuration:</p>
<pre><code class="toml">################################################################
# Consul Catalog configuration backend
################################################################

# Enable Consul Catalog configuration backend
#
# Optional
#
[consulCatalog]

# Consul server endpoint
#
# Required
#
endpoint = &quot;127.0.0.1:8500&quot;

# Default domain used.
#
# Optional
#
domain = &quot;consul.localhost&quot;

# Prefix for Consul catalog tags
#
# Optional
#
prefix = &quot;traefik&quot;
</code></pre>

<p>This backend will create routes matching on hostname based on the service name
used in consul.</p>
<p>Additional settings can be defined using Consul Catalog tags:</p>
<ul>
<li><code>traefik.enable=false</code>: disable this container in Træfik</li>
<li><code>traefik.protocol=https</code>: override the default <code>http</code> protocol</li>
<li><code>traefik.backend.weight=10</code>: assign this weight to the container</li>
<li><code>traefik.backend.circuitbreaker=NetworkErrorRatio() &gt; 0.5</code></li>
<li><code>traefik.backend.loadbalancer=drr</code>: override the default load balancing mode</li>
<li><code>traefik.backend.maxconn.amount=10</code>: set a maximum number of connections to the backend. Must be used in conjunction with the below label to take effect.</li>
<li><code>traefik.backend.maxconn.extractorfunc=client.ip</code>: set the function to be used against the request to determine what to limit maximum connections to the backend by. Must be used in conjunction with the above label to take effect.</li>
<li><code>traefik.frontend.rule=Host:test.traefik.io</code>: override the default frontend rule (Default: <code>Host:{containerName}.{domain}</code>).</li>
<li><code>traefik.frontend.passHostHeader=true</code>: forward client <code>Host</code> header to the backend.</li>
<li><code>traefik.frontend.priority=10</code>: override default frontend priority</li>
<li><code>traefik.frontend.entryPoints=http,https</code>: assign this frontend to entry points <code>http</code> and <code>https</code>. Overrides <code>defaultEntryPoints</code>.</li>
</ul>
<h2 id="etcd-backend">Etcd backend</h2>
<p>Træfik can be configured to use Etcd as a backend configuration:</p>
<pre><code class="toml">################################################################
# Etcd configuration backend
################################################################

# Enable Etcd configuration backend
#
# Optional
#
[etcd]

# Etcd server endpoint
#
# Required
#
endpoint = &quot;127.0.0.1:2379&quot;

# Enable watch Etcd changes
#
# Optional
#
watch = true

# Prefix used for KV store.
#
# Optional
#
prefix = &quot;/traefik&quot;

# Override default configuration template. For advanced users :)
#
# Optional
#
# filename = &quot;etcd.tmpl&quot;

# Use etcd user/pass authentication
#
# Optional
#
# username = foo
# password = bar

# Enable etcd TLS connection
#
# Optional
#
# [etcd.tls]
# ca = &quot;/etc/ssl/ca.crt&quot;
# cert = &quot;/etc/ssl/etcd.crt&quot;
# key = &quot;/etc/ssl/etcd.key&quot;
# insecureskipverify = true
</code></pre>

<p>Please refer to the <a href="../user-guide/kv-config/#key-value-storage-structure">Key Value storage structure</a> section to get documentation on traefik KV structure.</p>
<h2 id="zookeeper-backend">Zookeeper backend</h2>
<p>Træfik can be configured to use Zookeeper as a backend configuration:</p>
<pre><code class="toml">################################################################
# Zookeeper configuration backend
################################################################

# Enable Zookeeperconfiguration backend
#
# Optional
#
[zookeeper]

# Zookeeper server endpoint
#
# Required
#
endpoint = &quot;127.0.0.1:2181&quot;

# Enable watch Zookeeper changes
#
# Optional
#
watch = true

# Prefix used for KV store.
#
# Optional
#
prefix = &quot;traefik&quot;

# Override default configuration template. For advanced users :)
#
# Optional
#
# filename = &quot;zookeeper.tmpl&quot;
</code></pre>

<p>Please refer to the <a href="../user-guide/kv-config/#key-value-storage-structure">Key Value storage structure</a> section to get documentation on traefik KV structure.</p>
<h2 id="boltdb-backend">BoltDB backend</h2>
<p>Træfik can be configured to use BoltDB as a backend configuration:</p>
<pre><code class="toml">################################################################
# BoltDB configuration backend
################################################################

# Enable BoltDB configuration backend
#
# Optional
#
[boltdb]

# BoltDB file
#
# Required
#
endpoint = &quot;/my.db&quot;

# Enable watch BoltDB changes
#
# Optional
#
watch = true

# Prefix used for KV store.
#
# Optional
#
prefix = &quot;/traefik&quot;

# Override default configuration template. For advanced users :)
#
# Optional
#
# filename = &quot;boltdb.tmpl&quot;
</code></pre>

<h2 id="eureka-backend">Eureka backend</h2>
<p>Træfik can be configured to use Eureka as a backend configuration:</p>
<pre><code class="toml">################################################################
# Eureka configuration backend
################################################################

# Enable Eureka configuration backend
#
# Optional
#
[eureka]

# Eureka server endpoint.
# endpoint := &quot;http://my.eureka.server/eureka&quot;
#
# Required
#
endpoint = &quot;http://my.eureka.server/eureka&quot;

# Override default configuration time between refresh
#
# Optional
# default 30s
delay = &quot;1m&quot;

# Override default configuration template. For advanced users :)
#
# Optional
#
# filename = &quot;eureka.tmpl&quot;
</code></pre>

<p>Please refer to the <a href="../user-guide/kv-config/#key-value-storage-structure">Key Value storage structure</a> section to get documentation on traefik KV structure.</p>
<h2 id="ecs-backend">ECS backend</h2>
<p>Træfik can be configured to use Amazon ECS as a backend configuration:</p>
<pre><code class="toml">################################################################
# ECS configuration backend
################################################################

# Enable ECS configuration backend
#
# Optional
#
[ecs]

# ECS Cluster Name
#
# Optional
# Default: &quot;default&quot;
#
Cluster = &quot;default&quot;

# Enable watch ECS changes
#
# Optional
# Default: true
#
Watch = true

# Polling interval (in seconds)
#
# Optional
# Default: 15
#
RefreshSeconds = 15

# Expose ECS services by default in traefik
#
# Optional
# Default: true
#
ExposedByDefault = false

# Region to use when connecting to AWS
#
# Optional
#
# Region = &quot;us-east-1&quot;

# AccessKeyID to use when connecting to AWS
#
# Optional
#
# AccessKeyID = &quot;abc&quot;

# SecretAccessKey to use when connecting to AWS
#
# Optional
#
# SecretAccessKey = &quot;123&quot;

</code></pre>

<p>Labels can be used on task containers to override default behaviour:</p>
<ul>
<li><code>traefik.protocol=https</code>: override the default <code>http</code> protocol</li>
<li><code>traefik.weight=10</code>: assign this weight to the container</li>
<li><code>traefik.enable=false</code>: disable this container in Træfik</li>
<li><code>traefik.frontend.rule=Host:test.traefik.io</code>: override the default frontend rule (Default: <code>Host:{containerName}.{domain}</code>).</li>
<li><code>traefik.frontend.passHostHeader=true</code>: forward client <code>Host</code> header to the backend.</li>
<li><code>traefik.frontend.priority=10</code>: override default frontend priority</li>
<li><code>traefik.frontend.entryPoints=http,https</code>: assign this frontend to entry points <code>http</code> and <code>https</code>. Overrides <code>defaultEntryPoints</code>.</li>
</ul>
<p>If <code>AccessKeyID</code>/<code>SecretAccessKey</code> is not given credentials will be resolved in the following order:</p>
<ul>
<li>From environment variables; <code>AWS_ACCESS_KEY_ID</code>, <code>AWS_SECRET_ACCESS_KEY</code>, and <code>AWS_SESSION_TOKEN</code>.</li>
<li>Shared credentials, determined by <code>AWS_PROFILE</code> and <code>AWS_SHARED_CREDENTIALS_FILE</code>, defaults to <code>default</code> and <code>~/.aws/credentials</code>.</li>
<li>EC2 instance role or ECS task role</li>
</ul>
<p>Træfik needs the following policy to read ECS information:</p>
<pre><code class="json">{
    &quot;Version&quot;: &quot;2012-10-17&quot;,
    &quot;Statement&quot;: [
        {
            &quot;Sid&quot;: &quot;Traefik ECS read access&quot;,
            &quot;Effect&quot;: &quot;Allow&quot;,
            &quot;Action&quot;: [
                &quot;ecs:ListTasks&quot;,
                &quot;ecs:DescribeTasks&quot;,
                &quot;ecs:DescribeContainerInstances&quot;,
                &quot;ecs:DescribeTaskDefinition&quot;,
                &quot;ec2:DescribeInstances&quot;
            ],
            &quot;Resource&quot;: [
                &quot;*&quot;
            ]
        }
    ]
}
</code></pre>

<h1 id="rancher-backend">Rancher backend</h1>
<p>Træfik can be configured to use Rancher as a backend configuration:</p>
<pre><code class="toml">################################################################
# Rancher configuration backend
################################################################

# Enable Rancher configuration backend
#
# Optional
#
[rancher]

# Default domain used.
# Can be overridden by setting the &quot;traefik.domain&quot; label on an service.
#
# Required
#
domain = &quot;rancher.localhost&quot;

# Enable watch Rancher changes
#
# Optional
# Default: true
#
Watch = true

# Polling interval (in seconds)
#
# Optional
#
RefreshSeconds = 15

# Expose Rancher services by default in traefik
#
# Optional
# Default: true
#
ExposedByDefault = false

# Filter services with unhealthy states and health states
#
# Optional
# Default: false
#
EnableServiceHealthFilter = false

# Endpoint to use when connecting to Rancher
#
# Required
# Endpoint = &quot;http://rancherserver.example.com/v1&quot;

# AccessKey to use when connecting to Rancher
#
# Required
# AccessKey = &quot;XXXXXXXXXXXXXXXXXXXX&quot;

# SecretKey to use when connecting to Rancher
#
# Required
# SecretKey = &quot;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&quot;

</code></pre>

<p>As traefik needs access to the rancher API, you need to set the <code>endpoint</code>, <code>accesskey</code> and <code>secretkey</code> parameters. </p>
<p>To enable traefik to fetch information about the Environment it's deployed in only, you need to create an <code>Environment API Key</code>. This can be found within the API Key advanced options.</p>
<p>Labels can be used on task containers to override default behaviour:</p>
<ul>
<li><code>traefik.protocol=https</code>: override the default <code>http</code> protocol</li>
<li><code>traefik.weight=10</code>: assign this weight to the container</li>
<li><code>traefik.enable=false</code>: disable this container in Træfik</li>
<li><code>traefik.frontend.rule=Host:test.traefik.io</code>: override the default frontend rule (Default: <code>Host:{containerName}.{domain}</code>).</li>
<li><code>traefik.frontend.passHostHeader=true</code>: forward client <code>Host</code> header to the backend.</li>
<li><code>traefik.frontend.priority=10</code>: override default frontend priority</li>
<li><code>traefik.frontend.entryPoints=http,https</code>: assign this frontend to entry points <code>http</code> and <code>https</code>. Overrides <code>defaultEntryPoints</code>.</li>
<li><code>traefik.frontend.auth.basic=test:$apr1$H6uskkkW$IgXLP6ewTrSuBkTrqE8wj/,test2:$apr1$d9hr9HBB$4HxwgUir3HP4EsggP/QNo0</code>: Sets a Basic Auth for that frontend with the users test:test and test2:test2</li>
</ul>
<h2 id="dynamodb-backend">DynamoDB backend</h2>
<p>Træfik can be configured to use Amazon DynamoDB as a backend configuration:</p>
<pre><code class="toml">################################################################
# DynamoDB configuration backend
################################################################

# Enable DynamoDB configuration backend
#
# Optional
#
[dynamodb]

# DyanmoDB Table Name
#
# Optional
#
TableName = &quot;traefik&quot;

# Enable watch DynamoDB changes
#
# Optional
#
Watch = true

# Polling interval (in seconds)
#
# Optional
#
RefreshSeconds = 15

# Region to use when connecting to AWS
#
# Required
#
# Region = &quot;us-west-1&quot;

# AccessKeyID to use when connecting to AWS
#
# Optional
#
# AccessKeyID = &quot;abc&quot;

# SecretAccessKey to use when connecting to AWS
#
# Optional
#
# SecretAccessKey = &quot;123&quot;

# Endpoint of local dynamodb instance for testing
#
# Optional
#
# Endpoint = &quot;http://localhost:8080&quot;

</code></pre>

<p>Items in the <code>dynamodb</code> table must have three attributes: </p>
<ul>
<li><code>id</code> : string<ul>
<li>The id is the primary key.</li>
</ul>
</li>
<li><code>name</code> : string<ul>
<li>The name is used as the name of the frontend or backend.</li>
</ul>
</li>
<li><code>frontend</code> or <code>backend</code> : map<ul>
<li>This attribute's structure matches exactly the structure of a Frontend or Backend type in traefik. See <code>types/types.go</code> for details. The presence or absence of this attribute determines its type. So an item should never have both a <code>frontend</code> and a <code>backend</code> attribute. </li>
</ul>
</li>
</ul></div>
        </div>

        <footer class="col-md-12">
            <hr>
            
                <center>Copyright &copy; 2016-2017 Containous SAS</center>
            
            <center>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</center>
        </footer>

        <script src="../js/jquery-1.10.2.min.js"></script>
        <script src="../js/bootstrap-3.0.3.min.js"></script>
        <script src="../js/highlight.pack.js"></script>
        <script>var base_url = '..';</script>
        <script data-main="../mkdocs/js/search.js" src="../mkdocs/js/require.js"></script>
        <script src="../js/base.js"></script>
        <script src="../theme/js/structor-menu.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                        <h4 class="modal-title" id="exampleModalLabel">Search</h4>
                    </div>
                    <div class="modal-body">
                        <p>
                            From here you can search these documents. Enter
                            your search terms below.
                        </p>
                        <form role="form">
                            <div class="form-group">
                                <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                            </div>
                        </form>
                        <div id="mkdocs-search-results"></div>
                    </div>
                    <div class="modal-footer">
                    </div>
                </div>
            </div>
        </div>
    </body>
</html>